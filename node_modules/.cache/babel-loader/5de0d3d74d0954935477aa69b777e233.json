{"ast":null,"code":"import _slicedToArray from \"/home/burin17/proj/diploma/concept-funder/concept-funder-ui/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/burin17/proj/diploma/concept-funder/concept-funder-ui/src/FundraisingProject/FundraisingProjectDetails.js\";\nimport React, { useState } from \"react\";\nimport 'bootstrap/dist/css/bootstrap.css';\nimport { useEffect } from \"react\";\nimport crowdfundProject from '../contract/crowdfundProjectInstance';\nimport web3 from '../contract/web3';\nimport { useParams } from \"react-router-dom\";\nexport default function FundraisingProjectDetails() {\n  const _useParams = useParams(),\n        fpId = _useParams.fpId;\n\n  const _React$useState = React.useState(),\n        _React$useState2 = _slicedToArray(_React$useState, 2),\n        fProj = _React$useState2[0],\n        setFp = _React$useState2[1];\n\n  const _React$useState3 = React.useState([]),\n        _React$useState4 = _slicedToArray(_React$useState3, 2),\n        accounts = _React$useState4[0],\n        setAccounts = _React$useState4[1];\n\n  useEffect(() => {\n    fetch(\"http://localhost:18080/fundraising-projects/\" + fpId, {\n      method: 'GET',\n      headers: new Headers({\n        \"Authorization\": sessionStorage.jwtToken\n      })\n    }).then(response => response.json()).then(data => {\n      setFp(data);\n    });\n    web3.eth.getAccounts().then(accounts => {\n      setAccounts(accounts);\n    });\n  }, [fpId]);\n\n  if (fProj === undefined) {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 30\n      },\n      __self: this\n    });\n  }\n\n  function invest() {\n    const ethAmount = document.getElementById(\"ethAmount\").value;\n    const contractAddress = fProj.contractAddress;\n    crowdfundProject(contractAddress).methods.contribute().send({\n      from: accounts[0],\n      value: web3.utils.toWei(String(ethAmount), 'ether')\n    }).then(res => {\n      const currentAmount = parseInt(res.events.FundingReceived.returnValues.currentTotal, 10) / 1000000000000000000;\n      fProj.currentAmount = currentAmount;\n      fetch(\"http://localhost:18080/fundraising-projects/invest?id=\" + fProj.fundraisingProjectId + \"&currentAmount=\" + currentAmount, {\n        method: 'POST',\n        headers: new Headers({\n          \"Authorization\": sessionStorage.jwtToken\n        })\n      }).then(response => response.json()).then(data => {\n        setFp(data);\n      });\n    });\n  }\n\n  return React.createElement(\"li\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"bg-light m-5 p-3 fpWrapper\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 57\n    },\n    __self: this\n  }, React.createElement(\"h2\", {\n    className: \"p-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 58\n    },\n    __self: this\n  }, fProj.title), React.createElement(\"div\", {\n    className: \"p-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 59\n    },\n    __self: this\n  }, fProj.description), React.createElement(\"div\", {\n    className: \"row p-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 60\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col-sm\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 61\n    },\n    __self: this\n  }, \"User: \", fProj.founder.username), React.createElement(\"div\", {\n    className: \"col-sm\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 62\n    },\n    __self: this\n  }, \"Goal: \", fProj.amountGoal, \" ETH\"), React.createElement(\"div\", {\n    className: \"col-sm\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 63\n    },\n    __self: this\n  }, \"Due date: \", fProj.duration.substring(0, fProj.duration.indexOf('T'))), React.createElement(\"div\", {\n    className: \"col-sm\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 64\n    },\n    __self: this\n  }, \"Days: \", fProj.days), React.createElement(\"div\", {\n    className: \"col-sm\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 65\n    },\n    __self: this\n  }, \"Raised: \", fProj.currentAmount, \" ETH\")), React.createElement(\"div\", {\n    className: \"p-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67\n    },\n    __self: this\n  }, \"Tags:\"), React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"p-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69\n    },\n    __self: this\n  }, \"Status: \", fProj.status)), React.createElement(\"div\", {\n    className: \"input-group m-2 w-25\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 71\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    id: \"ethAmount\",\n    type: \"text\",\n    className: \"form-control\",\n    placeholder: \"ETH amount\",\n    \"aria-label\": \"ETH amount\",\n    \"aria-describedby\": \"basic-addon2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 72\n    },\n    __self: this\n  }), React.createElement(\"button\", {\n    id: \"startBtn\",\n    type: \"button\",\n    className: \"btn btn-primary\",\n    onClick: () => invest(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 74\n    },\n    __self: this\n  }, \"Contribute\"))));\n}","map":{"version":3,"sources":["/home/burin17/proj/diploma/concept-funder/concept-funder-ui/src/FundraisingProject/FundraisingProjectDetails.js"],"names":["React","useState","useEffect","crowdfundProject","web3","useParams","FundraisingProjectDetails","fpId","fProj","setFp","accounts","setAccounts","fetch","method","headers","Headers","sessionStorage","jwtToken","then","response","json","data","eth","getAccounts","undefined","invest","ethAmount","document","getElementById","value","contractAddress","methods","contribute","send","from","utils","toWei","String","res","currentAmount","parseInt","events","FundingReceived","returnValues","currentTotal","fundraisingProjectId","title","description","founder","username","amountGoal","duration","substring","indexOf","days","status"],"mappings":"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","sourcesContent":["import React, {useState} from \"react\";\nimport 'bootstrap/dist/css/bootstrap.css';\nimport {useEffect} from \"react\";\nimport crowdfundProject from '../contract/crowdfundProjectInstance';\nimport web3 from '../contract/web3';\nimport {useParams} from \"react-router-dom\";\n\nexport default function FundraisingProjectDetails() {\n    const {fpId} = useParams()\n    const [fProj, setFp] = React.useState();\n    const [accounts, setAccounts] = React.useState([]);\n\n    useEffect(() =>{\n        fetch(`http://localhost:18080/fundraising-projects/` + fpId,\n            {\n                method: 'GET',\n                headers: new Headers({\n                    \"Authorization\": sessionStorage.jwtToken\n                })\n            }).then(response => response.json())\n            .then(data => {\n                setFp(data);\n            });\n        web3.eth.getAccounts().then((accounts) => {\n            setAccounts(accounts);\n        });\n    }, [fpId])\n\n    if (fProj === undefined) {\n        return <div></div>\n    }\n\n    function invest() {\n        const ethAmount = document.getElementById(\"ethAmount\").value;\n        const contractAddress = fProj.contractAddress;\n        crowdfundProject(contractAddress).methods.contribute().send({\n            from: accounts[0],\n            value: web3.utils.toWei(String(ethAmount), 'ether'),\n        }).then((res) => {\n            const currentAmount = (parseInt(res.events.FundingReceived.returnValues.currentTotal, 10) / 1000000000000000000);\n            fProj.currentAmount = currentAmount;\n            fetch(`http://localhost:18080/fundraising-projects/invest?id=` + fProj.fundraisingProjectId\n                + \"&currentAmount=\" + currentAmount, {\n                method: 'POST',\n                headers: new Headers({\n                    \"Authorization\": sessionStorage.jwtToken\n                })\n            }).then(response => response.json())\n                .then(data => {\n                    setFp(data);\n                });\n        });\n    }\n\n    return (\n        <li>\n            <div className=\"bg-light m-5 p-3 fpWrapper\">\n                <h2 className=\"p-3\">{fProj.title}</h2>\n                <div className=\"p-3\">{fProj.description}</div>\n                <div className=\"row p-3\">\n                    <div className=\"col-sm\">User: {fProj.founder.username}</div>\n                    <div className=\"col-sm\">Goal: {fProj.amountGoal} ETH</div>\n                    <div className=\"col-sm\">Due date: {fProj.duration.substring(0, fProj.duration.indexOf('T'))}</div>\n                    <div className=\"col-sm\">Days: {fProj.days}</div>\n                    <div className=\"col-sm\">Raised: {fProj.currentAmount} ETH</div>\n                </div>\n                <div className=\"p-3\">Tags:</div>\n                <div>\n                    <div className=\"p-3\">Status: {fProj.status}</div>\n                </div>\n                <div className=\"input-group m-2 w-25\">\n                    <input id=\"ethAmount\" type=\"text\" className=\"form-control\" placeholder=\"ETH amount\"\n                           aria-label=\"ETH amount\" aria-describedby=\"basic-addon2\"/>\n                    <button id=\"startBtn\" type=\"button\" className=\"btn btn-primary\"\n                            onClick={() => invest()}>Contribute\n                    </button>\n                </div>\n            </div>\n        </li>\n    )\n}"]},"metadata":{},"sourceType":"module"}