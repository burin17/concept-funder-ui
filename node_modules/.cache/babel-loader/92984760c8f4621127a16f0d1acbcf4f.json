{"ast":null,"code":"import _slicedToArray from \"/home/burin17/proj/diploma/concept-funder/concept-funder-ui/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/burin17/proj/diploma/concept-funder/concept-funder-ui/src/FundraisingProject/FundraisingProjectDetails.js\";\nimport React, { useLayoutEffect, useState } from \"react\";\nimport 'bootstrap/dist/css/bootstrap.css';\nimport { useEffect } from \"react\";\nimport crowdfundProject from '../contract/crowdfundProjectInstance';\nimport web3 from '../contract/web3';\nimport { useParams } from \"react-router-dom\";\nimport FundraisingProject from \"./FundraisingProject\";\nimport PayoutRequest from \"../PayoutRequest\";\nimport '../fundraisingProjects.css';\nexport default function FundraisingProjectDetails() {\n  const _useParams = useParams(),\n        fpId = _useParams.fpId;\n\n  const _React$useState = React.useState(),\n        _React$useState2 = _slicedToArray(_React$useState, 2),\n        fProj = _React$useState2[0],\n        setFp = _React$useState2[1];\n\n  const _React$useState3 = React.useState([]),\n        _React$useState4 = _slicedToArray(_React$useState3, 2),\n        payoutRequests = _React$useState4[0],\n        setPayoutRequests = _React$useState4[1];\n\n  const _React$useState5 = React.useState(),\n        _React$useState6 = _slicedToArray(_React$useState5, 2),\n        currentUser = _React$useState6[0],\n        setCurrentUser = _React$useState6[1];\n\n  const _React$useState7 = React.useState([]),\n        _React$useState8 = _slicedToArray(_React$useState7, 2),\n        accounts = _React$useState8[0],\n        setAccounts = _React$useState8[1];\n\n  const _React$useState9 = React.useState(false),\n        _React$useState10 = _slicedToArray(_React$useState9, 2),\n        isLoaded = _React$useState10[0],\n        loaded = _React$useState10[1];\n\n  useEffect(() => {\n    loadData();\n  }, [fpId]);\n\n  async function loadData() {\n    await fetch(\"http://localhost:18080/fundraising-projects/\" + fpId, {\n      method: 'GET',\n      headers: new Headers({\n        \"Authorization\": sessionStorage.jwtToken\n      })\n    }).then(response => response.json()).then(data => setFp(data));\n    await fetch(\"http://localhost:18080/payout-requests/\" + fpId, {\n      method: 'GET',\n      headers: new Headers({\n        \"Authorization\": sessionStorage.jwtToken\n      })\n    }).then(response => response.json()).then(data => {\n      setPayoutRequests(data);\n    });\n    await fetch(\"http://localhost:18080/user/selfProfile\", {\n      method: 'GET',\n      headers: new Headers({\n        \"Authorization\": sessionStorage.jwtToken\n      })\n    }).then(response => response.json()).then(data => {\n      setCurrentUser(data);\n    });\n    loaded(true);\n  }\n\n  if (isLoaded === false) {\n    return React.createElement(\"div\", {\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 61\n      },\n      __self: this\n    });\n  }\n\n  function invest() {\n    const ethAmount = document.getElementById(\"ethAmount\").value;\n    const contractAddress = fProj.contractAddress;\n    crowdfundProject(contractAddress).methods.contribute().send({\n      from: accounts[0],\n      value: web3.utils.toWei(String(ethAmount), 'ether')\n    }).then(res => {\n      const currentAmount = parseInt(res.events.FundingReceived.returnValues.currentTotal, 10) / 1000000000000000000;\n      fProj.currentAmount = currentAmount;\n      fetch(\"http://localhost:18080/fundraising-projects/invest?id=\" + fProj.fundraisingProjectId + \"&currentAmount=\" + currentAmount, {\n        method: 'POST',\n        headers: new Headers({\n          \"Authorization\": sessionStorage.jwtToken\n        })\n      }).then(response => response.json()).then(data => {\n        setFp(data);\n      });\n    });\n  }\n\n  function setRPFormVisibility(isVisible) {\n    if (isVisible) {\n      document.getElementById(\"formWrapper\").style.display = \"flex\";\n    } else {\n      document.getElementById(\"formWrapper\").style.display = \"none\";\n    }\n  }\n\n  return React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  }, React.createElement(\"li\", {\n    style: {\n      marginLeft: 35\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    id: \"formWrapper\",\n    className: \"auth-wrapper\",\n    style: {\n      position: \"absolute\",\n      display: \"none\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"auth-inner\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 98\n    },\n    __self: this\n  }, React.createElement(\"form\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 99\n    },\n    __self: this\n  }, React.createElement(\"h3\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 100\n    },\n    __self: this\n  }, \"Request for payout\"), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }, \"Ether amount\"), React.createElement(\"input\", {\n    id: \"etherAmount\",\n    type: \"text\",\n    className: \"form-control\",\n    placeholder: \"Ether amount\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 104\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 108\n    },\n    __self: this\n  }, \"Intention\"), React.createElement(\"input\", {\n    id: \"intention\",\n    type: \"text\",\n    className: \"form-control\",\n    placeholder: \"Intention\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 109\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 112\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 113\n    },\n    __self: this\n  }, \"Reporting\"), React.createElement(\"input\", {\n    id: \"reporting\",\n    type: \"text\",\n    className: \"form-control\",\n    placeholder: \"Reporting\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 114\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"form-group\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 117\n    },\n    __self: this\n  }, React.createElement(\"label\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 118\n    },\n    __self: this\n  }, \"Days\"), React.createElement(\"input\", {\n    id: \"days\",\n    type: \"email\",\n    className: \"form-control\",\n    placeholder: \"Days\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 119\n    },\n    __self: this\n  })), React.createElement(\"br\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 122\n    },\n    __self: this\n  }), React.createElement(\"button\", {\n    type: \"button\",\n    className: \"btn btn-primary btn-block\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 123\n    },\n    __self: this\n  }, \"Request\"), React.createElement(\"button\", {\n    type: \"button\",\n    className: \"btn btn-secondary btn-block\",\n    style: {\n      marginLeft: \"175px\"\n    },\n    onClick: () => setRPFormVisibility(false),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 124\n    },\n    __self: this\n  }, \"Cancel\")))), React.createElement(\"div\", {\n    className: \"bg-light m-5 p-3 fpWrapper\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 129\n    },\n    __self: this\n  }, React.createElement(\"h2\", {\n    className: \"p-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130\n    },\n    __self: this\n  }, fProj.title), React.createElement(\"div\", {\n    className: \"p-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131\n    },\n    __self: this\n  }, fProj.description), React.createElement(\"div\", {\n    className: \"row p-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 132\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col-sm\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133\n    },\n    __self: this\n  }, \"User: \", fProj.founder.username), React.createElement(\"div\", {\n    className: \"col-sm\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134\n    },\n    __self: this\n  }, \"Goal: \", fProj.amountGoal, \" ETH\"), React.createElement(\"div\", {\n    className: \"col-sm\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135\n    },\n    __self: this\n  }, \"Due date: \", fProj.duration.substring(0, fProj.duration.indexOf('T'))), React.createElement(\"div\", {\n    className: \"col-sm\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136\n    },\n    __self: this\n  }, \"Days: \", fProj.days), React.createElement(\"div\", {\n    className: \"col-sm\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137\n    },\n    __self: this\n  }, \"Raised: \", fProj.currentAmount, \" ETH\")), React.createElement(\"div\", {\n    className: \"p-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 139\n    },\n    __self: this\n  }, \"Tags:\"), React.createElement(\"div\", {\n    className: \"input-group m-2 w-25\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 140\n    },\n    __self: this\n  }, React.createElement(\"input\", {\n    id: \"ethAmount\",\n    type: \"text\",\n    className: \"form-control\",\n    placeholder: \"ETH amount\",\n    \"aria-label\": \"ETH amount\",\n    \"aria-describedby\": \"basic-addon2\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 141\n    },\n    __self: this\n  }), React.createElement(\"button\", {\n    id: \"startBtn\",\n    type: \"button\",\n    className: \"btn btn-primary\",\n    onClick: () => invest(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 143\n    },\n    __self: this\n  }, \"Contribute\")), fProj.founder.id == currentUser.id && fProj.status == \"FINANCED\" && React.createElement(\"button\", {\n    id: \"startBtn\",\n    type: \"button\",\n    className: \"m-2 btn btn-primary\",\n    onClick: () => setRPFormVisibility(true),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 148\n    },\n    __self: this\n  }, \"Request payout\"))), React.createElement(\"h3\", {\n    style: {\n      marginLeft: 80,\n      color: \"#fff\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153\n    },\n    __self: this\n  }, \"Requests for pay out:\"), React.createElement(\"ul\", {\n    style: {\n      listStyle: \"none\"\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154\n    },\n    __self: this\n  }, payoutRequests.map(payoutRequest => {\n    return React.createElement(PayoutRequest, {\n      pr: payoutRequest,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 156\n      },\n      __self: this\n    });\n  })));\n}","map":{"version":3,"sources":["/home/burin17/proj/diploma/concept-funder/concept-funder-ui/src/FundraisingProject/FundraisingProjectDetails.js"],"names":["React","useLayoutEffect","useState","useEffect","crowdfundProject","web3","useParams","FundraisingProject","PayoutRequest","FundraisingProjectDetails","fpId","fProj","setFp","payoutRequests","setPayoutRequests","currentUser","setCurrentUser","accounts","setAccounts","isLoaded","loaded","loadData","fetch","method","headers","Headers","sessionStorage","jwtToken","then","response","json","data","invest","ethAmount","document","getElementById","value","contractAddress","methods","contribute","send","from","utils","toWei","String","res","currentAmount","parseInt","events","FundingReceived","returnValues","currentTotal","fundraisingProjectId","setRPFormVisibility","isVisible","style","display","marginLeft","position","title","description","founder","username","amountGoal","duration","substring","indexOf","days","id","status","color","listStyle","map","payoutRequest"],"mappings":"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","sourcesContent":["import React, {useLayoutEffect, useState} from \"react\";\nimport 'bootstrap/dist/css/bootstrap.css';\nimport {useEffect} from \"react\";\nimport crowdfundProject from '../contract/crowdfundProjectInstance';\nimport web3 from '../contract/web3';\nimport {useParams} from \"react-router-dom\";\nimport FundraisingProject from \"./FundraisingProject\";\nimport PayoutRequest from\"../PayoutRequest\"\nimport '../fundraisingProjects.css';\n\nexport default function FundraisingProjectDetails() {\n    const {fpId} = useParams()\n    const [fProj, setFp] = React.useState();\n    const [payoutRequests, setPayoutRequests] = React.useState([]);\n    const [currentUser, setCurrentUser] = React.useState();\n    const [accounts, setAccounts] = React.useState([]);\n    const [isLoaded, loaded] = React.useState(false);\n\n    useEffect(() =>{\n        loadData();\n    }, [fpId])\n\n    async function loadData() {\n        await fetch(`http://localhost:18080/fundraising-projects/` + fpId,\n            {\n                method: 'GET',\n                headers: new Headers({\n                    \"Authorization\": sessionStorage.jwtToken\n                })\n            })\n            .then(response => response.json())\n            .then(data => setFp(data));\n\n        await fetch(`http://localhost:18080/payout-requests/` + fpId,\n            {\n                method: 'GET',\n                headers: new Headers({\n                    \"Authorization\": sessionStorage.jwtToken\n                })\n            })\n            .then(response => response.json())\n            .then(data => {\n                setPayoutRequests(data);\n            })\n\n        await fetch(`http://localhost:18080/user/selfProfile`,\n            {\n                method: 'GET',\n                headers: new Headers({\n                    \"Authorization\": sessionStorage.jwtToken\n                })\n            })\n            .then(response => response.json())\n            .then(data => {\n                setCurrentUser(data);\n            })\n        loaded(true);\n    }\n\n    if (isLoaded === false) {\n        return <div></div>\n    }\n\n    function invest() {\n        const ethAmount = document.getElementById(\"ethAmount\").value;\n        const contractAddress = fProj.contractAddress;\n        crowdfundProject(contractAddress).methods.contribute().send({\n            from: accounts[0],\n            value: web3.utils.toWei(String(ethAmount), 'ether'),\n        }).then((res) => {\n            const currentAmount = (parseInt(res.events.FundingReceived.returnValues.currentTotal, 10) / 1000000000000000000);\n            fProj.currentAmount = currentAmount;\n            fetch(`http://localhost:18080/fundraising-projects/invest?id=` + fProj.fundraisingProjectId\n                + \"&currentAmount=\" + currentAmount, {\n                method: 'POST',\n                headers: new Headers({\n                    \"Authorization\": sessionStorage.jwtToken\n                })\n            }).then(response => response.json())\n                .then(data => {\n                    setFp(data);\n                });\n        });\n    }\n\n    function setRPFormVisibility(isVisible) {\n        if (isVisible) {\n            document.getElementById(\"formWrapper\").style.display = \"flex\";\n        } else {\n            document.getElementById(\"formWrapper\").style.display = \"none\";\n        }\n    }\n\n    return (\n        <div>\n            <li style={{marginLeft: 35}}>\n                <div id=\"formWrapper\" className=\"auth-wrapper\" style={{position: \"absolute\", display: \"none\"}}>\n                    <div className=\"auth-inner\">\n                        <form>\n                            <h3>Request for payout</h3>\n\n                            <div className=\"form-group\">\n                                <label>Ether amount</label>\n                                <input id=\"etherAmount\" type=\"text\" className=\"form-control\" placeholder=\"Ether amount\" />\n                            </div>\n\n                            <div className=\"form-group\">\n                                <label>Intention</label>\n                                <input id=\"intention\" type=\"text\" className=\"form-control\" placeholder=\"Intention\" />\n                            </div>\n\n                            <div className=\"form-group\">\n                                <label>Reporting</label>\n                                <input id=\"reporting\" type=\"text\" className=\"form-control\" placeholder=\"Reporting\" />\n                            </div>\n\n                            <div className=\"form-group\">\n                                <label>Days</label>\n                                <input id=\"days\" type=\"email\" className=\"form-control\" placeholder=\"Days\" />\n                            </div>\n\n                            <br/>\n                            <button type=\"button\" className=\"btn btn-primary btn-block\">Request</button>\n                            <button type=\"button\" className=\"btn btn-secondary btn-block\" style={{marginLeft: \"175px\"}}\n                                    onClick={() => setRPFormVisibility(false)}>Cancel</button>\n                        </form>\n                    </div>\n                </div>\n                <div className=\"bg-light m-5 p-3 fpWrapper\">\n                    <h2 className=\"p-3\">{fProj.title}</h2>\n                    <div className=\"p-3\">{fProj.description}</div>\n                    <div className=\"row p-3\">\n                        <div className=\"col-sm\">User: {fProj.founder.username}</div>\n                        <div className=\"col-sm\">Goal: {fProj.amountGoal} ETH</div>\n                        <div className=\"col-sm\">Due date: {fProj.duration.substring(0, fProj.duration.indexOf('T'))}</div>\n                        <div className=\"col-sm\">Days: {fProj.days}</div>\n                        <div className=\"col-sm\">Raised: {fProj.currentAmount} ETH</div>\n                    </div>\n                    <div className=\"p-3\">Tags:</div>\n                    <div className=\"input-group m-2 w-25\">\n                        <input id=\"ethAmount\" type=\"text\" className=\"form-control\" placeholder=\"ETH amount\"\n                               aria-label=\"ETH amount\" aria-describedby=\"basic-addon2\"/>\n                        <button id=\"startBtn\" type=\"button\" className=\"btn btn-primary\"\n                                onClick={() => invest()}>Contribute\n                        </button>\n                    </div>\n                    {fProj.founder.id == currentUser.id && fProj.status == \"FINANCED\" &&\n                        <button id=\"startBtn\" type=\"button\" className=\"m-2 btn btn-primary\"\n                                onClick={() => setRPFormVisibility(true)}>Request payout</button>\n                    }\n                </div>\n            </li>\n            <h3 style={{marginLeft: 80, color: \"#fff\"}}>Requests for pay out:</h3>\n            <ul style={{listStyle: \"none\"}}>\n                {payoutRequests.map(payoutRequest => {\n                    return <PayoutRequest pr={payoutRequest}/>\n                })}\n            </ul>\n        </div>\n    )\n}"]},"metadata":{},"sourceType":"module"}