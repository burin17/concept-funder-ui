{"ast":null,"code":"import _slicedToArray from \"/home/burin17/proj/diploma/concept-funder/concept-funder-ui/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/burin17/proj/diploma/concept-funder/concept-funder-ui/src/FundraisingProject/FundraisingProject.js\";\nimport React, { useState } from \"react\";\nimport 'bootstrap/dist/css/bootstrap.css';\nimport { useEffect } from \"react\";\nimport crowdfundInstance from '../contract/crowdfundInstance';\nimport crowdfundProject from '../contract/crowdfundProjectInstance';\nimport web3 from '../contract/web3';\nexport default function FundraisingProject({\n  fp,\n  isModeration,\n  isSelfProfile\n}) {\n  const _React$useState = React.useState(fp),\n        _React$useState2 = _slicedToArray(_React$useState, 2),\n        fProj = _React$useState2[0],\n        setFp = _React$useState2[1];\n\n  const _React$useState3 = React.useState(false),\n        _React$useState4 = _slicedToArray(_React$useState3, 2),\n        isInApprovedState = _React$useState4[0],\n        setIsInApprovedState = _React$useState4[1];\n\n  const _React$useState5 = React.useState(null),\n        _React$useState6 = _slicedToArray(_React$useState5, 2),\n        account = _React$useState6[0],\n        setAccount = _React$useState6[1];\n\n  function approve() {\n    fetch(\"http://localhost:18080/moderation/\".concat(fProj.fundraisingProjectId, \"?\") + new URLSearchParams({\n      isValid: true\n    }), {\n      method: 'POST',\n      headers: new Headers({\n        \"Authorization\": sessionStorage.jwtToken\n      })\n    }).then(response => response.json()).then(data => {\n      setFp(data);\n    });\n  }\n\n  function reject() {\n    fetch(\"http://localhost:18080/moderation/\".concat(fProj.fundraisingProjectId, \"?\") + new URLSearchParams({\n      isValid: false\n    }), {\n      method: 'POST',\n      headers: new Headers({\n        \"Authorization\": sessionStorage.jwtToken\n      })\n    }).then(response => response.json()).then(data => {\n      setFp(data);\n    });\n  }\n\n  function startFp() {\n    crowdfundInstance.methods.startProject(fProj.title, fProj.description, fProj.duration, web3.utils.toWei(fProj.amountGoal, 'ether')).send({\n      from: account\n    }).then(res => {\n      const projectInfo = res.events.ProjectStarted.returnValues;\n      projectInfo.isLoading = false;\n      projectInfo.currentAmount = 0;\n      projectInfo.currentState = 0;\n      projectInfo.contract = crowdfundProject(projectInfo.contractAddress);\n      console.log(projectInfo);\n    });\n    fetch(\"http://localhost:18080/fundraising-projects/start?id=\" + fProj.fundraisingProjectId, {\n      method: 'POST',\n      headers: new Headers({\n        \"Authorization\": sessionStorage.jwtToken\n      })\n    }).then(response => response.json()).then(data => {\n      setFp(data);\n      if (fProj.status == \"APPROVED\") document.getElementById(\"startBtn\").style.display = 'none';\n    });\n  }\n\n  useEffect(() => {\n    setFp(fp);\n    setIsInApprovedState(fProj.status == \"APPROVED\");\n    web3.eth.getAccounts().then(accounts => {\n      setAccount(accounts);\n    });\n  }, [fp]);\n  console.log(fProj);\n  return React.createElement(\"li\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"bg-light m-5 p-3 fpWrapper\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82\n    },\n    __self: this\n  }, React.createElement(\"h2\", {\n    className: \"p-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 83\n    },\n    __self: this\n  }, fProj.title), React.createElement(\"div\", {\n    className: \"p-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 84\n    },\n    __self: this\n  }, fProj.description), React.createElement(\"div\", {\n    className: \"row p-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"col-sm\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }, \"User: \", fProj.founder.username), React.createElement(\"div\", {\n    className: \"col-sm\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 87\n    },\n    __self: this\n  }, \"Goal: \", fProj.amountGoal), React.createElement(\"div\", {\n    className: \"col-sm\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 88\n    },\n    __self: this\n  }, \"Due date: \", fProj.duration), React.createElement(\"div\", {\n    className: \"col-sm\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 89\n    },\n    __self: this\n  }, \"Raised: \")), React.createElement(\"div\", {\n    className: \"p-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 91\n    },\n    __self: this\n  }, \"Tags: \"), isModeration > 0 && React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 93\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"p-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 94\n    },\n    __self: this\n  }, \"Status: \", fProj.status), React.createElement(\"div\", {\n    className: \"p-1\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 95\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    type: \"button\",\n    className: \"btn btn-primary btn-block m-2\",\n    onClick: () => approve(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 96\n    },\n    __self: this\n  }, \"Approve\"), React.createElement(\"button\", {\n    type: \"button\",\n    className: \"btn btn-primary btn-block m-2\",\n    onClick: () => reject(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97\n    },\n    __self: this\n  }, \"Reject\"))), isSelfProfile > 0 && !(isModeration > 0) && React.createElement(\"div\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 102\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"p-3\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 103\n    },\n    __self: this\n  }, \"Status: \", fProj.status)), isInApprovedState > 0 && React.createElement(\"button\", {\n    id: \"startBtn\",\n    type: \"button\",\n    className: \"btn btn-primary btn-block m-2\",\n    onClick: () => startFp(),\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 107\n    },\n    __self: this\n  }, \"Start company\")));\n}","map":{"version":3,"sources":["/home/burin17/proj/diploma/concept-funder/concept-funder-ui/src/FundraisingProject/FundraisingProject.js"],"names":["React","useState","useEffect","crowdfundInstance","crowdfundProject","web3","FundraisingProject","fp","isModeration","isSelfProfile","fProj","setFp","isInApprovedState","setIsInApprovedState","account","setAccount","approve","fetch","fundraisingProjectId","URLSearchParams","isValid","method","headers","Headers","sessionStorage","jwtToken","then","response","json","data","reject","startFp","methods","startProject","title","description","duration","utils","toWei","amountGoal","send","from","res","projectInfo","events","ProjectStarted","returnValues","isLoading","currentAmount","currentState","contract","contractAddress","console","log","status","document","getElementById","style","display","eth","getAccounts","accounts","founder","username"],"mappings":"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","sourcesContent":["import React, {useState} from \"react\";\nimport 'bootstrap/dist/css/bootstrap.css';\nimport {useEffect} from \"react\";\nimport crowdfundInstance from '../contract/crowdfundInstance';\nimport crowdfundProject from '../contract/crowdfundProjectInstance';\nimport web3 from '../contract/web3';\n\nexport default function FundraisingProject({fp, isModeration, isSelfProfile}) {\n    const [fProj, setFp] = React.useState(fp);\n    const [isInApprovedState, setIsInApprovedState] = React.useState(false);\n    const [account, setAccount] = React.useState(null);\n\n    function approve() {\n        fetch(`http://localhost:18080/moderation/${fProj.fundraisingProjectId}?` + new URLSearchParams({\n            isValid: true,\n        }), {\n            method: 'POST',\n            headers: new Headers({\n                \"Authorization\": sessionStorage.jwtToken\n            })\n        }).then(response => response.json())\n            .then(data => {\n                setFp(data);\n            });\n    }\n\n    function reject() {\n        fetch(`http://localhost:18080/moderation/${fProj.fundraisingProjectId}?` + new URLSearchParams({\n            isValid: false,\n        }), {\n            method: 'POST',\n            headers: new Headers({\n                \"Authorization\": sessionStorage.jwtToken\n            })\n        }).then(response => response.json())\n            .then(data => {\n                setFp(data);\n            });\n    }\n\n    function startFp() {\n        crowdfundInstance.methods.startProject(\n            fProj.title,\n            fProj.description,\n            fProj.duration,\n            web3.utils.toWei(fProj.amountGoal, 'ether'),\n        ).send({\n            from: account,\n        }).then((res) => {\n            const projectInfo = res.events.ProjectStarted.returnValues;\n            projectInfo.isLoading = false;\n            projectInfo.currentAmount = 0;\n            projectInfo.currentState = 0;\n            projectInfo.contract = crowdfundProject(projectInfo.contractAddress);\n            console.log(projectInfo);\n        });\n        fetch(`http://localhost:18080/fundraising-projects/start?id=` + fProj.fundraisingProjectId, {\n            method: 'POST',\n            headers: new Headers({\n                \"Authorization\": sessionStorage.jwtToken\n            })\n        }).then(response => response.json())\n            .then(data => {\n                setFp(data);\n                if (fProj.status == \"APPROVED\")\n                    document.getElementById(\"startBtn\").style.display = 'none'\n            });\n    }\n\n    useEffect(() =>{\n        setFp(fp)\n        setIsInApprovedState(fProj.status == \"APPROVED\");\n        web3.eth.getAccounts().then((accounts) => {\n            setAccount(accounts);\n        });\n    },[fp])\n\n    console.log(fProj);\n\n    return (\n        <li>\n            <div className=\"bg-light m-5 p-3 fpWrapper\">\n                <h2 className=\"p-3\">{fProj.title}</h2>\n                <div className=\"p-3\">{fProj.description}</div>\n                <div className=\"row p-3\">\n                    <div className=\"col-sm\">User: {fProj.founder.username}</div>\n                    <div className=\"col-sm\">Goal: {fProj.amountGoal}</div>\n                    <div className=\"col-sm\">Due date: {fProj.duration}</div>\n                    <div className=\"col-sm\">Raised: </div>\n                </div>\n                <div className=\"p-3\">Tags: </div>\n                {isModeration > 0 &&\n                    <div>\n                        <div className=\"p-3\">Status: {fProj.status}</div>\n                        <div className=\"p-1\">\n                            <button type=\"button\" className=\"btn btn-primary btn-block m-2\" onClick={() => approve()}>Approve</button>\n                            <button type=\"button\" className=\"btn btn-primary btn-block m-2\" onClick={() => reject()}>Reject</button>\n                        </div>\n                    </div>\n                }\n                {isSelfProfile > 0 && !(isModeration > 0) &&\n                    <div>\n                        <div className=\"p-3\">Status: {fProj.status}</div>\n                    </div>\n                }\n                {isInApprovedState > 0 &&\n                    <button id=\"startBtn\" type=\"button\" className=\"btn btn-primary btn-block m-2\" onClick={() => startFp()}>Start company</button>}\n            </div>\n        </li>\n    )\n}"]},"metadata":{},"sourceType":"module"}